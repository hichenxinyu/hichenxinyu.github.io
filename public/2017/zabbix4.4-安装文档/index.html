<!DOCTYPE html>
<html lang="en-us">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="Covey.Liu">
  
  
  
  <link rel="prev" href="https://example.com/1/gerrit-codereview%E5%B7%A5%E5%85%B7%E6%90%AD%E5%BB%BA%E9%85%8D%E7%BD%AE/" />
  <link rel="next" href="https://example.com/2018/%E6%9B%B4%E6%8D%A2yum%E6%BA%90/" />
  <link rel="canonical" href="https://example.com/2017/zabbix4.4-%E5%AE%89%E8%A3%85%E6%96%87%E6%A1%A3/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           Zabbix4.4安装 | LeaveIt
       
  </title>
  <meta name="title" content="Zabbix4.4安装 | LeaveIt">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https:\/\/example.com"
    },
    "articleSection" : "posts",
    "name" : "Zabbix4.4安装",
    "headline" : "Zabbix4.4安装",
    "description" : "Zabbix介绍  Zabbix 是一个企业级的分布式开源监控方案。 zabbix server ，zabbix agent\x26gt; 与可选组件zabbix proxy。\n API 功能 ： 应用api功能，可以方便的和其他系统结合，包括手机客户端的使用。\n更多功能请查看http:\/\/www.zabbix.com\/documentation.php\n安装zabbix环境及准备工作 zabbix 依赖 LAMP （LNMP 也可以）\n安装zabbix  （单机）\x26ndash;\x26gt; LAMP （架构）\x26ndash;\x26gt; LAP \x2b MYSQL（生产环境，建议数据库与 Zabbix-Server 分开部署） 服务端端口：10051 客户端端口：10050   1，安装Zabbix需要的硬件环境及软件版本，我这里在官网上查了一下，你可以根据自己的环境和要求来选择：下表是几个硬件配置的示例:\n   名称 平台 **CPU\/**内存 数据库 监控主机数量     小型 CentOS 虚拟应用 MySQL InnoDB 100   中型 CentOS 2 CPU cores\/2GB MySQL InnoDB 500   大型 RedHat Enterprise Linux 4 CPU cores\/8GB RAID10 MySQL InnoDB or PostgreSQL \x26gt;1000   巨大型 RedHat Enterprise Linux 8 CPU cores\/16GB 快速RAID10 MySQL InnoDB or PostgreSQL \x26gt;10000    具体的配置极其依赖于Active Item数量和轮询频率。如需要进行大规模部署，强烈建议将数据库进行独立部署。",
    "inLanguage" : "en-us",
    "author" : "Covey.Liu",
    "creator" : "Covey.Liu",
    "publisher": "Covey.Liu",
    "accountablePerson" : "Covey.Liu",
    "copyrightHolder" : "Covey.Liu",
    "copyrightYear" : "2017",
    "datePublished": "2017-11-28 00:00:00 \x2b0000 UTC",
    "dateModified" : "2017-11-28 00:00:00 \x2b0000 UTC",
    "url" : "https:\/\/example.com\/2017\/zabbix4.4-%E5%AE%89%E8%A3%85%E6%96%87%E6%A1%A3\/",
    "wordCount" : "416",
    "keywords" : [  "LeaveIt"]
}
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://example.com">LeaveIt</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://example.com">LeaveIt</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">Zabbix4.4安装</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="https://example.com" rel="author">Covey.Liu</a> with ♥ 
                <span class="post-time">
                on <time datetime=2017-11-28 itemprop="datePublished">November 28, 2017</time>
                </span>
                in
                
        </div>
    </header>
    <div class="post-content">
        

        
            
        

        
        
     
          
          
          

          
          
          

          <h3 id="zabbix">Zabbix介绍</h3>
<blockquote>
<p>Zabbix 是一个企业级的分布式开源监控方案。
zabbix server ，zabbix agent&gt; 与可选组件zabbix proxy。</p>
</blockquote>
<p><strong>API 功能 ：</strong> 应用api功能，可以方便的和其他系统结合，包括手机客户端的使用。</p>
<p>更多功能请查看<a href="http://www.zabbix.com/documentation.php">http://www.zabbix.com/documentation.php</a></p>
<h3 id="zabbix-1">安装zabbix环境及准备工作</h3>
<p>zabbix 依赖 LAMP （LNMP 也可以）</p>
<h5 id="zabbix-2">安装zabbix</h5>
<ul>
<li>（单机）&ndash;&gt; LAMP</li>
<li>（架构）&ndash;&gt; LAP + MYSQL（生产环境，建议数据库与 Zabbix-Server 分开部署）</li>
<li>服务端端口：10051</li>
<li>客户端端口：10050</li>
</ul>
<hr>
<p>1，安装Zabbix需要的硬件环境及软件版本，我这里在官网上查了一下，你可以根据自己的环境和要求来选择：<!-- raw HTML omitted -->下表是几个硬件配置的示例:</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>平台</th>
<th>**CPU/**内存</th>
<th>数据库</th>
<th>监控主机数量</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>小型</strong></td>
<td>CentOS</td>
<td>虚拟应用</td>
<td>MySQL   InnoDB</td>
<td>100</td>
</tr>
<tr>
<td><strong>中型</strong></td>
<td>CentOS</td>
<td>2 CPU   cores/2GB</td>
<td>MySQL   InnoDB</td>
<td>500</td>
</tr>
<tr>
<td><strong>大型</strong></td>
<td>RedHat   Enterprise Linux</td>
<td>4 CPU   cores/8GB</td>
<td>RAID10   MySQL InnoDB or PostgreSQL</td>
<td>&gt;1000</td>
</tr>
<tr>
<td><strong>巨大型</strong></td>
<td>RedHat   Enterprise Linux</td>
<td>8 CPU   cores/16GB</td>
<td>快速RAID10 MySQL InnoDB or PostgreSQL</td>
<td>&gt;10000</td>
</tr>
</tbody>
</table>
<p>具体的配置极其依赖于Active Item数量和轮询频率。如需要进行大规模部署，强烈建议将数据库进行独立部署。</p>
<hr>
<p>2，接下来我说一下我实验环境</p>
<table>
<thead>
<tr>
<th>操作系统</th>
<th>主机IP</th>
<th>主机名称</th>
<th>安装软件</th>
<th>安装zabbix版本</th>
<th>MySQL版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>Centos7.3</td>
<td>192.68.0.20</td>
<td>zabbix</td>
<td>Zabbix-server</td>
<td>Zabbix 3.4.10</td>
<td>MySQL5.7.22</td>
</tr>
<tr>
<td>centos6.5</td>
<td>192.168.0.157</td>
<td>Test02</td>
<td>zabbix-agent</td>
<td>zabbix-agent-3.4.10</td>
<td>/</td>
</tr>
</tbody>
</table>
<h3 id="zabbix-3">安装zabbix</h3>
<p>3.1）在监控主机上需要预先安装yum 源，下面正式开始安装；</p>
<pre><code>rpm -Uvh https://repo.zabbix.com/zabbix/4.4/rhel/6/x86_64/zabbix-release-4.4-1.el6.noarch.rpm
yum clean all
</code></pre><p>3.2）安装Zabbix-server包和zabbix-agent包</p>
<pre><code>yum -y install zabbix-server-mysql zabbix-web-mysql zabbix-agent
</code></pre><p>3.3）下载安装mysql源</p>
<pre><code>rpm -ivh https://dev.mysql.com/get/mysql57-community-release-el7-11.noarch.rpm
</code></pre><p>3.4)查看当前可用的Mysql安装源</p>
<pre><code>[root@zabbix ~]# yum repolist enabled | grep &quot;mysql.*-community.*&quot;
mysql-connectors-community/x86_64 MySQL Connectors Community                  51
mysql-tools-community/x86_64      MySQL Tools Community                       63
mysql57-community/x86_64          MySQL 5.7 Community Server                 267
</code></pre><h3 id="mysql-">MySQL 安装&amp;配置</h3>
<pre><code>yum -y install mysql-community-server
</code></pre><p>3.6）启动mysql服务并设置开机启动</p>
<pre><code>[root@zabbix ~]#systemctl start mysqld
[root@zabbix ~]#systemctl enable mysqld
</code></pre><p>3.7)进入MySQL并修改密码</p>
<pre><code>[root@zabbix ~]# cat /var/log/mysqld.log | grep password
或者：/usr/bin/mysqladmin -u root password 'new-password'

[root@zabbix ~]# mysql -uroot -pnew-password
mysql&gt; SET PASSWORD = PASSWORD ('Pass123!');
如果想用简单的密码必须先改一个变量；
mysql&gt; set global validate_password_policy=0;
mysql&gt; SET PASSWORD = PASSWORD ('12345678');
不然你改密码会不通过，会有密码复杂度要求。
</code></pre><p>3.8）创建数据库和zabbix用户并授权</p>
<pre><code>mysql&gt; create database zabbix character set utf8 collate utf8_bin;
Query OK, 1 row affected (10.03 sec)
mysql&gt; grant all privileges on zabbix.* to zabbix@localhost identified by 'Pass123!';
Query OK, 0 rows affected, 1 warning (0.00 sec)
</code></pre><p>3.9)导入初始架构（Schema）和数据</p>
<pre><code>[root@zabbix ~]#cd zabbix-server-mysql-4.4.1/
[root@zabbix  zabbix-server-mysql-3.4.10 ~]#zcat create.sql.gz | mysql -uzabbix -pPass123! -D zabbix
mysql: [Warning] Using a password on the command line interface can be insecure.
</code></pre><p>3.10)然后进入mysql查看这些内容是否导入进去</p>
<pre><code>mysql&gt; show tables from zabbix;
</code></pre><p><img src="https://blog-pic-1253367462.cos.ap-shanghai.myqcloud.com/1574069473892-5a56476b-3d7f-46f5-b559-02bb58924e09.png" alt="image.png"></p>
<pre><code>mysql&gt; select count(*) tables,table_schema from information_schema.tables where table_schema =&quot;zabbix&quot;;
</code></pre><hr>
<p>4.修改配置文件，给服务授权、启动Zabbix Server服务<!-- raw HTML omitted -->4.1）修改配置文件</p>
<pre><code>备注：记得先备份 cp /etc/zabbix/zabbix_server.conf  /etc/zabbix/zabbix_server.conf.bak 
[root@zabbix ~]#vim  /etc/zabbix/zabbix_server.conf
DBHost=localhost
DBName=zabbix
DBUser=zabbix
DBPassword=Pass123!
</code></pre><p>4.2）给服务授权</p>
<pre><code>[root@zabbix ~]#chown -R zabbix:zabbix /etc/zabbix/
[root@zabbix ~]#chmod -R 755 /etc/zabbix/
</code></pre><h5 id="zabbix-server">启动Zabbix Server服务</h5>
<pre><code>[root@zabbix ~]#systemctl start  zabbix-server
[root@zabbix ~]#systemctl enable zabbix-server
</code></pre><p>备注：这里会有一个坑，就是在启动zabbix服务会失败，Job for zabbix-server.service failed. See &lsquo;systemctl status zabbix-server.service&rsquo; and &lsquo;journalctl -xn&rsquo; for details.查了一下原因是gnutls-3.3的高版本问题，解决办法是;1,先卸载这个高版本的gnutls-3.3,命令：rpm -e gnutls-3.3.24-1.el7.x86_64 &ndash;nodeps2，然后去网上下载一个gnutls-3.1的版本，然后使用命令rpm -Uvh &ndash;force gnutls-3.1.18-8.el7.x86_64.rpm</p>
<hr>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h5 id="zabbixphp">编辑Zabbix前端的PHP配置</h5>
<ul>
<li>Zabbix前端的Apache配置文件位于 /etc/httpd/conf.d/zabbix.conf 。一些PHP设置已经完成了配置。</li>
</ul>
<pre><code>#CentOS6 中获取zabbix apache 配置路径命令
rpm -ql zabbix-web | grep example.conf
</code></pre><pre><code>[root@zabbix ~]# vim /etc/httpd/conf.d/zabbix.conf
找到&lt;IfModule mod_php5.c&gt;标签下面
添加一条
php_value date.timezone Asia/Shanghai
</code></pre><ul>
<li>启动apache服务，并设置开机自启</li>
</ul>
<pre><code>[root@zabbix ~]#systemctl start httpd
[root@zabbix ~]#systemctl enable  httpd
</code></pre><hr>
<p><!-- raw HTML omitted --><!-- raw HTML omitted --></p>
<h4 id="zabbix-web-">Zabbix Web 页面配置</h4>
<p>1，访问ip：<a href="http://192.168.0.20/zabbix/index.php">http://IP/zabbix/index.php</a><!-- raw HTML omitted --></p>
<p>中间省略一部分&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;直接到登录界面了。<!-- raw HTML omitted --></p>
<p><img src="https://blog-pic-1253367462.cos.ap-shanghai.myqcloud.com/image-20200324220001544.png" alt="">默认的用户名是：Admin 密码：zabbix<!-- raw HTML omitted --></p>
<h4 id="zabbix-agent">Zabbix Agent</h4>
<ul>
<li>添加一台Linux客户端机器（ip:192.168.0.157）</li>
</ul>
<p>访问zabbix官网：<a href="https://www.zabbix.com/download?zabbix=3.4&amp;os_distribution=centos&amp;os_version=6&amp;db=MySQL">https://www.zabbix.com/download?zabbix=3.4&amp;os_distribution=centos&amp;os_version=6&amp;db=MySQL</a></p>
<ul>
<li>添加Yum源:</li>
</ul>
<pre><code>#Centos6
rpm -ivh  http://repo.zabbix.com/zabbix/3.4/rhel/6/x86_64/zabbix-release-3.4-1.el6.noarch.rpm
#Centos7 
rpm -ivh http://repo.zabbix.com/zabbix/3.4/rhel/7/x86_64/zabbix-agent-3.4.1-1.el7.x86_64.rpm
</code></pre><ul>
<li>安装客户端agent软件</li>
</ul>
<pre><code>yum -y install zabbix-agent
</code></pre><ul>
<li>修改agent配置文件</li>
</ul>
<pre><code>grep -v '^$' /etc/zabbix/zabbix_agentd.conf |grep -v '^#'

PidFile=/var/run/zabbix/zabbix_agentd.pid
LogFile=/var/log/zabbix/zabbix_agentd.log
LogFileSize=0
Server=192.168.2.82
ServerActive=192.168.2.82:10050
Hostname=Test02
Include=/etc/zabbix/zabbix_agentd.d/*.conf
</code></pre><pre><code># 给配置文件授权
chmod 775 /etc/zabbix/zabbix_agentd.conf
# 启动agent服务并查看服务启动成功没有
/etc/init.d/zabbix-agent start 
netstat -lntup |grep zabbix_agent
</code></pre><ul>
<li>
<p>Web 页面添加第一台主机</p>
<ul>
<li>
<p>配置&ndash;主机&mdash;创建主机</p>
<p><img src="https://blog-pic-1253367462.cos.ap-shanghai.myqcloud.com/image-20200324215908603.png" alt="image-20200324215908603"></p>
</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>添加主机详细信息</li>
</ul>
<p><img src="https://blog-pic-1253367462.cos.ap-shanghai.myqcloud.com/image-20200324215844994.png" alt="image-20200324215844994"></p>
<h5 id="heading">添加主机模板信息</h5>
<p><img src="https://blog-pic-1253367462.cos.ap-shanghai.myqcloud.com/image-20200324215828877.png" alt="image-20200324215828877"></p>
<p>这样一台客户端Linux基本添加完成，过几分钟就能开到Zabbix图标变绿证明添加成功了。</p>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>Covey.Liu </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://example.com/2017/zabbix4.4-%E5%AE%89%E8%A3%85%E6%96%87%E6%A1%A3/>https://example.com/2017/zabbix4.4-%E5%AE%89%E8%A3%85%E6%96%87%E6%A1%A3/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="https://example.com">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://example.com/1/gerrit-codereview%E5%B7%A5%E5%85%B7%E6%90%AD%E5%BB%BA%E9%85%8D%E7%BD%AE/" class="prev" rel="prev" title="Gerrit CodeReview代码审核工具搭建配置"><i class="iconfont icon-left"></i>&nbsp;Gerrit CodeReview代码审核工具搭建配置</a>
         
        
        <a href="https://example.com/2018/%E6%9B%B4%E6%8D%A2yum%E6%BA%90/" class="next" rel="next" title="Centos更换yum源">Centos更换yum源&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
          
                 
          
    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2011 - 2020</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://example.com">Covey.Liu</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>












    
     <link href="//lib.baomitu.com/lightgallery/1.6.11/css/lightgallery.min.css" rel="stylesheet">  
      
     <script src="/js/vendor_gallery.min.js" async="" ></script>
    
  



     </div>
  </body>
</html>
